<div class="user-management-container">
  <h1>üë• User Management</h1>

  <!-- Success/Error Messages -->
  <div *ngIf="success" class="success-message">
    ‚úì {{ success }}
  </div>

  <div *ngIf="error && !showForm" class="error-message">
    ‚ö†Ô∏è {{ error }}
  </div>

  <!-- Toolbar -->
  <div class="toolbar">
    <div class="search-box">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="searchUsers()"
        placeholder="üîç Search users..."
        class="search-input"
      />
    </div>
    <button (click)="showAddForm()" class="btn-add" *ngIf="!showForm">
      ‚ûï Add New User
    </button>
  </div>

  <!-- User Form -->
  <div *ngIf="showForm" class="form-container">
    <div class="form-header">
      <h2>{{ isEditing ? 'Edit User' : 'Add New User' }}</h2>
    </div>

    <div *ngIf="error" class="error-message">
      ‚ö†Ô∏è {{ error }}
    </div>

    <form (ngSubmit)="saveUser()" class="user-form">
      <div class="form-row">
        <div class="form-group">
          <label for="firstName">First Name *</label>
          <input
            type="text"
            id="firstName"
            [(ngModel)]="currentUser.firstName"
            name="firstName"
            required
            [disabled]="loading"
          />
        </div>

        <div class="form-group">
          <label for="lastName">Last Name *</label>
          <input
            type="text"
            id="lastName"
            [(ngModel)]="currentUser.lastName"
            name="lastName"
            required
            [disabled]="loading"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="username">Username *</label>
          <input
            type="text"
            id="username"
            [(ngModel)]="currentUser.username"
            name="username"
            required
            [disabled]="loading"
          />
        </div>

        <div class="form-group">
          <label for="emailId">Email *</label>
          <input
            type="email"
            id="emailId"
            [(ngModel)]="currentUser.emailId"
            name="emailId"
            required
            [disabled]="loading"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="password">Password {{ isEditing ? '(leave blank to keep current)' : '*' }}</label>
          <input
            type="password"
            id="password"
            [(ngModel)]="currentUser.password"
            name="password"
            [required]="!isEditing"
            [disabled]="loading"
            placeholder="Min 6 characters"
          />
        </div>

        <div class="form-group">
          <label for="phoneNumber">Phone Number</label>
          <input
            type="tel"
            id="phoneNumber"
            [(ngModel)]="currentUser.phoneNumber"
            name="phoneNumber"
            [disabled]="loading"
          />
        </div>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            [(ngModel)]="currentUser.active"
            name="active"
            [disabled]="loading"
          />
          <span>Active</span>
        </label>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-save" [disabled]="loading">
          {{ loading ? 'Saving...' : 'Save' }}
        </button>
        <button type="button" (click)="cancelForm()" class="btn-cancel" [disabled]="loading">
          Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="loading && !showForm" class="loading">
    <div class="spinner"></div>
    <p>Loading users...</p>
  </div>

  <!-- Users Table -->
  <div *ngIf="!loading && !showForm" class="table-container">
    <table class="users-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Username</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers">
          <td>{{ user.firstName }} {{ user.lastName }}</td>
          <td>{{ user.username }}</td>
          <td>{{ user.emailId }}</td>
          <td>{{ user.phoneNumber || 'N/A' }}</td>
          <td>
            <span [class]="user.active ? 'status-active' : 'status-inactive'">
              {{ user.active ? '‚úì Active' : '‚úó Inactive' }}
            </span>
          </td>
          <td class="actions">
            <button (click)="editUser(user)" class="btn-edit" title="Edit">
              ‚úèÔ∏è
            </button>
            <button
              (click)="toggleUserStatus(user)"
              [class]="user.active ? 'btn-deactivate' : 'btn-activate'"
              [title]="user.active ? 'Deactivate' : 'Activate'"
            >
              {{ user.active ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è' }}
            </button>
            <button (click)="deleteUser(user)" class="btn-delete" title="Delete">
              üóëÔ∏è
            </button>
          </td>
        </tr>
        <tr *ngIf="filteredUsers.length === 0">
          <td colspan="6" class="no-data">No users found</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

